# Image API v1.0 (æç®€ç‰ˆ) æ–‡æ¡£

Image API v1.0 æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„å›¾ç‰‡åˆ†å‘æœåŠ¡ï¼Œæ”¯æŒè®¾å¤‡è‡ªé€‚åº”ã€æœ¬åœ°å­˜å‚¨ä¸æ•°æ®åº“å¤–é“¾æ··åˆæ¨¡å¼ã€‚è¯¥ç‰ˆæœ¬å·²ç®€åŒ–æ¶æ„ï¼Œä¸å†è¿›è¡Œè‡ªåŠ¨æ ¼å¼è½¬æ¢ï¼Œä»¥ç¡®ä¿æœ€é«˜æ•ˆçš„å“åº”å’ŒåŸç”»è´¨è¾“å‡ºã€‚

## åŸºæœ¬ä¿¡æ¯

- **APIç‰ˆæœ¬**: 1.0
- **è¯·æ±‚æ–¹å¼**: GET
- **å“åº”æ ¼å¼**: JSON (é»˜è®¤) / TEXT / é‡å®šå‘
- **æ”¯æŒæ ¼å¼**: JPEG, PNG, GIF, WebP, AVIF

## æ ¸å¿ƒç‰¹æ€§

- ğŸ“± **è®¾å¤‡è‡ªé€‚åº”**: è‡ªåŠ¨æ£€æµ‹ç§»åŠ¨ç«¯/æ¡Œé¢ç«¯ UAï¼Œè¿”å›å¯¹åº”æ¯”ä¾‹çš„å›¾ç‰‡ã€‚
- âš¡ **åŸç”Ÿåˆ†å‘**: ç›´æ¥åˆ†å‘åŸå§‹ä¸Šä¼ æ ¼å¼ï¼ˆå«é€æ˜ PNG å’ŒåŠ¨æ€ GIFï¼‰ï¼Œä¸è¿›è¡ŒäºŒæ¬¡å¤„ç†ã€‚
- ğŸŒ **æ··åˆå­˜å‚¨**: æ”¯æŒæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿå­˜å‚¨ä¸æ•°æ®åº“å¤–é“¾ï¼ˆExternalï¼‰æ¨¡å¼åˆ‡æ¢ã€‚
- ğŸ—„ï¸ **ç»“æ„å…¼å®¹**: å®Œç¾å…¼å®¹æ‰å¹³åŒ–ç›®å½•ç»“æ„åŠæ—§ç‰ˆæœ¬çš„æ ¼å¼å­ç›®å½•ç»“æ„ã€‚

## è¯·æ±‚åœ°å€

```
GET /image_api.php
```

## è¯·æ±‚å‚æ•°

| å‚æ•°å | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|--------|------|
| `count` | int | 1 | è¿”å›å›¾ç‰‡æ•°é‡ï¼ŒèŒƒå›´: 1-50 |
| `type` | string | auto | è®¾å¤‡ç±»å‹: `pc`(æ¡Œé¢ç«¯) / `pe`(ç§»åŠ¨ç«¯)ã€‚ç•™ç©ºåˆ™æ ¹æ® UA è‡ªåŠ¨æ£€æµ‹ |
| `format` | string | json | å“åº”æ ¼å¼: `json` (é»˜è®¤) / `text` (çº¯æ–‡æœ¬URL) / `url` (ç­‰åŒtext) |
| `return` | string | json | è¿”å›è¡Œä¸º: `json` / `redirect` (ä»…å½“ count=1 æ—¶æœ‰æ•ˆï¼Œç›´æ¥é‡å®šå‘åˆ°å›¾ç‰‡) |
| `external` | boolean | false | å­˜å‚¨æ¨¡å¼: `true`/`1` (å¤–é“¾æ¨¡å¼) / `false`/`0` (æœ¬åœ°æ¨¡å¼) |

---

## ä½¿ç”¨æ¨¡å¼

### 1. æœ¬åœ°æ¨¡å¼ (Default)

ä»æœåŠ¡å™¨çš„ `images` ç›®å½•éšæœºè·å–å›¾ç‰‡ã€‚

#### ç›®å½•ç»“æ„
```
images/
â”œâ”€â”€ pc/          # æ¡Œé¢ç«¯/æ¨ªå±å›¾ç‰‡ (jpg, png, gif, webp, avif)
â””â”€â”€ pe/          # ç§»åŠ¨ç«¯/ç«–å±å›¾ç‰‡ (jpg, png, gif, webp, avif)
```

#### è¯·æ±‚ç¤ºä¾‹
```bash
# è·å–1å¼ éšæœºå›¾ç‰‡ (è‡ªåŠ¨è¯†åˆ«è®¾å¤‡)
GET /image_api.php

# è·å–5å¼  PC ç«¯å›¾ç‰‡ (JSON æ ¼å¼)
GET /image_api.php?count=5&type=pc

# è·å–ç§»åŠ¨ç«¯å›¾ç‰‡å¹¶ç›´æ¥è·³è½¬åˆ°åŸå›¾
GET /image_api.php?type=pe&return=redirect
```

### 2. å¤–é“¾æ¨¡å¼ (External)

ä»æ•°æ®åº“ `images` è¡¨ä¸­è·å– `storage_type='external'` çš„éšæœºå›¾ç‰‡ã€‚

#### è¯·æ±‚ç¤ºä¾‹
```bash
# ä»å¤–é“¾åº“è·å–1å¼ å›¾ç‰‡
GET /image_api.php?external=true

# ä»å¤–é“¾åº“è·å–3å¼ ç§»åŠ¨ç«¯å›¾ç‰‡çš„ URL åˆ—è¡¨
GET /image_api.php?external=true&type=pe&count=3&format=text
```

---

## å“åº”æ ¼å¼

### JSON å“åº” (é»˜è®¤)

```json
{
  "success": true,
  "count": 2,
  "type": "pc",
  "mode": "random",
  "total_available": 150,
  "timestamp": 1704556800,
  "api_version": "1.0",
  "return_type": "json",
  "external_mode": false,
  "user_agent": "Mozilla/5.0...",
  "images": [
    {
      "filename": "20240106_abc123.png",
      "path": "D:/code/picflow-api/images/pc/20240106_abc123.png",
      "url": "http://localhost/images/pc/20240106_abc123.png",
      "extension": "png",
      "type": "pc",
      "size": 102455,
      "source": "images"
    }
  ]
}
```

### TEXT å“åº”

å½“ `format=text` æ—¶ï¼Œæ¯è¡Œè¿”å›ä¸€ä¸ª URLï¼š

```text
http://example.com/images/pc/pic1.jpg
http://example.com/images/pc/pic2.png
```

---

## é”™è¯¯å¤„ç†

### é”™è¯¯å“åº”

```json
{
  "success": false,
  "message": "æ²¡æœ‰æ‰¾åˆ°å›¾ç‰‡ï¼Œè¯·æ£€æŸ¥ images ç›®å½•",
  "count": 0,
  "images": []
}
```

---

## æŠ€æœ¯å»ºè®®

1.  **ç›´æ¥å¼•ç”¨**ï¼šå¯¹äºä¸ªäººåšå®¢èƒŒæ™¯æˆ–éšæœºå£çº¸ï¼Œæ¨èä½¿ç”¨ `return=redirect` å‚æ•°ç›´æ¥ä½œä¸º `<img>` æ ‡ç­¾çš„ `src`ã€‚
2.  **CDN é…åˆ**ï¼šå»ºè®®å°† `images/` ç›®å½•æŒ‚è½½åˆ° CDN ä¸‹ï¼Œä»¥è·å¾—æé€Ÿä½“éªŒã€‚
3.  **PNG ä¼˜åŒ–**ï¼šè™½ç„¶ç³»ç»Ÿæ”¯æŒ PNGï¼Œä½†è‹¥å¯¹åŠ è½½é€Ÿåº¦æœ‰æç«¯è¦æ±‚ï¼Œå»ºè®®ä¸Šä¼ å‰å…ˆè¿›è¡Œå‹ç¼©ã€‚

---
**Image API v1.0** - ä¿æŒçº¯ç²¹ï¼Œè¿½æ±‚æè‡´å“åº”ã€‚
